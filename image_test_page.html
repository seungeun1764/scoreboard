<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì´ë¯¸ì§€ ë³€ê²½ ì˜ˆì œ</title>
  <style>
    body {
      text-align: center;
      margin: 0;
      padding: 0;
      height: 100vh;  /* í™”ë©´ ì „ì²´ë¥¼ ì°¨ì§€í•˜ë„ë¡ ì„¤ì • */
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;  /* ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ */
      align-items: center;  /* ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬ */
      position: relative;  /* ë¶€ëª¨ ìš”ì†Œì— ìƒëŒ€ì  ìœ„ì¹˜ ì§€ì • */
      flex-direction: column;  /* ì´ë¯¸ì§€ë“¤ì´ ì„¸ë¡œë¡œ ì •ë ¬ë˜ë„ë¡ ì„¤ì • */
    }
    img {
      cursor: pointer;
      border: 2px solid #000000;
      border-radius: 10px;
      display: none; /* ì´ˆê¸°ì—ëŠ” ì´ë¯¸ì§€ë¥¼ ìˆ¨ê¹€ */
      position: absolute;  /* ì´ë¯¸ì§€ê°€ ì ˆëŒ€ ìœ„ì¹˜ë¡œ ë°°ì¹˜ë˜ë„ë¡ ì„¤ì • */
    }
    #myImage {
      z-index: 2;  /* ì•ìª½ì— ì˜¤ë„ë¡ ì„¤ì • */
      width: 50px;  /* ì´ë¯¸ì§€ ë„ˆë¹„ 50pxë¡œ ì„¤ì • */
    }
    #backGround {
      z-index: 1;  /* ë°°ê²½ ì´ë¯¸ì§€ê°€ ë’¤ì— ì˜¤ë„ë¡ ì„¤ì • */
      width: 100%;  /* ë°°ê²½ ì´ë¯¸ì§€ë¥¼ í™”ë©´ ë„ˆë¹„ì— ë§ê²Œ ì„¤ì • */
      height: auto;
      display: none; /* ì´ˆê¸°ì—ëŠ” ë°°ê²½ ì´ë¯¸ì§€ ìˆ¨ê¹€ */
    }
    #loading {
      font-size: 18px;
      color: #595a9e;
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <h1>ì´ë¯¸ì§€ë¥¼ ëˆŒëŸ¬ë³´ì„¸ìš”!</h1>
  <img id="backGround" src="" alt="ë°°ê²½">
  <img id="myImage" src="" alt="ì´ë¯¸ì§€" onclick="changeImage()">
  <div id="loading">ì´ë¯¸ì§€ë¥¼ ë¡œë”© ì¤‘...</div> <!-- ë¡œë”© ë©”ì‹œì§€ í‘œì‹œ -->

  <script>
    const API_KEY = "AIzaSyAagQ2Py-QOfMysJiI2Vi2YE8qzksEntEg"; // ğŸ”‘ ì—¬ê¸°ì— ë³¸ì¸ API í‚¤ ì…ë ¥
    const query = "cat meme gif";
    const query_2 = "house";
    const SEARCH_ENGINE_ID = "b2d082885ce8243e3"; // ë³¸ì¸ Search Engine ID ì…ë ¥

    let gifs = [];
    let pictures = [];

    // ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ ë¹„ë™ê¸°ì ìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
    async function fetchImages() {
      try {
        const url = `https://www.googleapis.com/customsearch/v1?q=${encodeURIComponent(query)}&key=${API_KEY}&cx=${SEARCH_ENGINE_ID}&searchType=image&fileType=gif`;
        const url_2 = `https://www.googleapis.com/customsearch/v1?q=${encodeURIComponent(query_2)}&key=${API_KEY}&cx=${SEARCH_ENGINE_ID}&searchType=image&fileType=jpg`;

        const res = await fetch(url);
        const res_2 = await fetch(url_2);

        // ì‘ë‹µ ìƒíƒœ í™•ì¸
        if (!res.ok) {
          throw new Error(`HTTP ì˜¤ë¥˜! ìƒíƒœ ì½”ë“œ: ${res.status}`);
        }

        const data = await res.json();
        const data_2 = await res_2.json();

        gifs = data.items
            .filter(item => item.mime === 'image/gif')  // mime íƒ€ì…ì´ 'image/gif'ì¸ ê²ƒë§Œ í•„í„°ë§
            .map(item => item.link);  // GIF ì´ë¯¸ì§€ ë§í¬ë§Œ ì¶”ì¶œ

        pictures = data_2.items
            .filter(item => item.mime === 'image/jpeg')  // mime íƒ€ì…ì´ 'image/jpeg'ì¸ ê²ƒë§Œ í•„í„°ë§
            .map(item => item.link);  // JPG ì´ë¯¸ì§€ ë§í¬ë§Œ ì¶”ì¶œ

        console.log(gifs);  // ì½˜ì†”ì— GIF ì´ë¯¸ì§€ URL ì¶œë ¥
        console.log(pictures);  // ì½˜ì†”ì— JPG ì´ë¯¸ì§€ URL ì¶œë ¥

        if (gifs.length > 0 && pictures.length > 0) {
          // ì²« ë²ˆì§¸ ì´ë¯¸ì§€ë¡œ ì´ˆê¸°í™”
          document.getElementById("myImage").src = gifs[0];
          document.getElementById("backGround").src = pictures[0];
          document.getElementById("myImage").style.display = 'block';  // ì²« ë²ˆì§¸ ì´ë¯¸ì§€ í‘œì‹œ
          document.getElementById("backGround").style.display = 'block'; // ë°°ê²½ ì´ë¯¸ì§€ í‘œì‹œ
          document.getElementById('loading').style.display = 'none';  // ë¡œë”© ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
          setRandomPosition();  // ì´ë¯¸ì§€ ìœ„ì¹˜ë¥¼ ëœë¤ìœ¼ë¡œ ì„¤ì •
        } else {
          document.getElementById('loading').innerText = 'GIF ë˜ëŠ” ë°°ê²½ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.';
        }

      } catch (error) {
        console.error("ì´ë¯¸ì§€ ë¡œë”© ì‹¤íŒ¨:", error);
        document.getElementById('loading').innerText = 'ì´ë¯¸ì§€ ë¡œë”©ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
      }
    }

    // ì´ë¯¸ì§€ ìœ„ì¹˜ë¥¼ ëœë¤ìœ¼ë¡œ ì„¤ì •í•˜ëŠ” í•¨ìˆ˜
    function setRandomPosition() {
      const myImage = document.getElementById("myImage");
      const bodyWidth = window.innerWidth;
      const bodyHeight = window.innerHeight;

      // ëœë¤ ìœ„ì¹˜ ê³„ì‚°
      const randomX = Math.floor(Math.random() * (bodyWidth - 100));  // 100pxì€ ì´ë¯¸ì§€ì˜ ë„ˆë¹„
      const randomY = Math.floor(Math.random() * (bodyHeight - 100)); // 100pxì€ ì´ë¯¸ì§€ì˜ ë†’ì´

      myImage.style.left = `${randomX}px`;
      myImage.style.top = `${randomY}px`;
    }

    // ì´ë¯¸ì§€ ë³€ê²½ í•¨ìˆ˜
    let currentIndex = 0;
    let currentIndex_2 = 0;

    function changeImage() {
      if (gifs.length > 0) {
        // ì¸ë±ìŠ¤ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ë°”ê¾¼ë‹¤
        currentIndex = (currentIndex + 1) % gifs.length;
        document.getElementById("myImage").src = gifs[currentIndex];
      } else {
        console.log("GIF ì´ë¯¸ì§€ ë¡œë”©ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
      }

      if (pictures.length > 0) {
        // ì¸ë±ìŠ¤ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ë°”ê¾¼ë‹¤
        currentIndex_2 = (currentIndex_2 + 1) % pictures.length;
        document.getElementById("backGround").src = pictures[currentIndex_2];
      } else {
        console.log("ë°°ê²½ ì´ë¯¸ì§€ ë¡œë”©ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
      }

      // ì´ë¯¸ì§€ ìœ„ì¹˜ ë‹¤ì‹œ ëœë¤ìœ¼ë¡œ ì„¤ì •
      setRandomPosition();
    }

    // í˜ì´ì§€ ë¡œë”© ì‹œ ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸°
    fetchImages();
  </script>

</body>
</html>
